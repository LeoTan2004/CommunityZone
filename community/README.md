# community后端接口说明

### 1. 登录

**url**：`/Interface/login.php`

**参数**：

| 参数名   | 协议 | 说明   |
| -------- | ---- | ------ |
| username | POST | 用户名 |
| password | POST | 密码   |

**返回值**:

| code | message                                  | 说明                           |
| ---- | ---------------------------------------- | ------------------------------ |
| 0    | 登录成功                                 | 账号密码正确，登录成功         |
| -3   | arguments error!                         | 缺少参数                       |
| -2   | username invalid! 或者 password invalid! | 参数不符合规范                 |
| -1   | 登录失败                                 | 登录失败，说明账号或密码不正确 |

### 2. 注册

**url**：`/Interface/register.php`

**参数**：

| 参数名    | 协议 | 说明             |
| --------- | ---- | ---------------- |
| username  | POST | 用户名           |
| password  | POST | 密码             |
| email     | POST | 邮箱             |
| signature | POST | 个性签名（可选） |
| nickname  | POST | 昵称（可选）     |

**返回值**:

| code | message                                                    | 说明                                 |
| ---- | ---------------------------------------------------------- | ------------------------------------ |
| 0    | 成功                                                       | 账号密码正确，登录成功               |
| -3   | arguments error!                                           | 缺少参数                             |
| -2   | username invalid! \|  password invalid! \|  email invalid! | 参数不符合规范                       |
| -4   | 用户已存在 \| 邮箱已被占用                                 | 注册失败，说明用户民或者邮箱已被使用 |
| -255 | 创建失败                                                   | 未知错误，数据库操作失败             |

### 3. 安全登出

**url**：`/Interface/logout.php`

无参数，无返回值；

### 4. 写评论

**url**：`/Interface/writecomment.php`

**参数**：

| 参数名  | 协议 | 说明                                            |
| ------- | ---- | ----------------------------------------------- |
| content | POST | 发言内容                                        |
| theme   | POST | 发言主题，如果是回复发言，主题就是回复对象的mid |


**返回值**:

| code | message                  | 说明                       |
| ---- | ------------------------ | -------------------------- |
| 0    | 添加成功                 | 添加成功                   |
| -3   | arguments error!         | 缺少参数                   |
| -1   | 请先登录                 | 账户还未登录               |
| -2   | 请填写主题 \| 请填写内容 | 主题或内容为空，不符合条件 |

### 5. （根据主题|内容|用户）获取评论

**url**：`/Interface/getComments.php`（通过主题获取评论）

**url**：`Interface/searchComment.php`（通过内容搜索评论）

**url1**：`Interface/getCommentsByUser.php`（查看用户发表的评论）

**参数**：

| 参数名  | 协议 | 说明                    |
| ------- | ---- | ----------------------- |
| offset  | GET  | 偏移量（可选，默认为0） |
| theme   | GET  | 要查询的主题            |
| user_id | GET  | 要查询的用户id          |
| content | GET  | 要查询的内容            |

**返回值**:

| code | message          | 说明                  |
| ---- | ---------------- | --------------------- |
| -1   | 请先登录         | 账户还未登录成功      |
| -3   | arguments error! | 缺少参数              |
| 0    | successful       | 查询成功,数据在date中 |

**date**:[将返回查询到的数据,最多一次50条]

| 参数名   | 类型   | 说明                              |
| -------- | ------ | --------------------------------- |
| mId      | int    | 发言的id                          |
| mUserId  | int    | 发言者的id                        |
| mTheme   | string | 发言的主题                        |
| mContent | string | 发言的内容                        |
| mRid     | int    | 访问权限（0表示全局，-1表示匿名） |

### 5. 点赞

**url**：`Interface/addFavor.php`

**参数**：

| 参数名 | 协议 | 说明         |
| ------ | ---- | ------------ |
| mid    | POST | 点赞的帖子id |


**返回值**:

| code | message                          | 说明                     |
| ---- | -------------------------------- | ------------------------ |
| -1   | 请先登录                         | 账户还未登录成功         |
| -3   | arguments error!                 | 缺少参数                 |
| -2   | 用户id参数错误 \| 评论id参数错误 | 参数不正确               |
| 0    | 点赞成功                         | 点赞成功                 |
| -255 | 操作失败                         | 未知错误，数据库操作失败 |

### 6. 取消点赞

**url**：`Interface/cancelFavor.php`

**参数**：

| 参数名 | 协议 | 说明         |
| ------ | ---- | ------------ |
| mid    | POST | 点赞的帖子id |


**返回值**:

| code | message                          | 说明                     |
| ---- | -------------------------------- | ------------------------ |
| -1   | 请先登录                         | 账户还未登录成功         |
| -3   | arguments error!                 | 缺少参数                 |
| -2   | 用户id参数错误 \| 评论id参数错误 | 参数不正确               |
| 0    | 取消成功                         | 取消点赞成功             |
| -255 | 操作失败                         | 未知错误，数据库操作失败 |

### 7. 获取（用户或者帖子的）点赞数

**url**：`Interface/checkFavor.php`

**参数**：

| 参数名 | 协议 | 说明                                  |
| ------ | ---- | ------------------------------------- |
| mid    | GET  | 要查询的帖子id（可选，但是优先于uid） |
| uid    | GET  | 要查询的用户id（可选）                |


**返回值**:

| code | message                       | 说明                              |
| ---- | ----------------------------- | --------------------------------- |
| -1   | 请先登录                      | 账户还未登录成功                  |
| -3   | arguments error!              | 缺少参数                          |
| -2   | 用户id参数错误 \| mid参数错误 | 参数不正确                        |
| 0    | 查询成功                      | 查询成功，数据放在date中，int类型 |
| -255 | 操作失败                      | 未知错误，数据库操作失败          |
